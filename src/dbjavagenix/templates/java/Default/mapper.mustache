<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="{{package}}.dao.{{entityName}}Dao">

    <resultMap type="{{package}}.entity.{{entityName}}" id="{{entityName}}Map">
{{#columns}}
        <result property="{{javaName}}" column="{{name}}" jdbcType="{{jdbcType}}"/>
{{/columns}}
    </resultMap>

    <!--查询单个-->
    <select id="queryById" resultMap="{{entityName}}Map">
        select
{{#columns}}
            {{name}}{{^last}},{{/last}}
{{/columns}}
        from {{tableName}}
        where {{primaryKey.name}} = #{{{primaryKey.javaName}}}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="{{entityName}}Map">
        select
{{#columns}}
            {{name}}{{^last}},{{/last}}
{{/columns}}
        from {{tableName}}
        <where>
{{#columns}}
            <if test="{{javaName}} != null{{#isStringType}} and {{javaName}} != ''{{/isStringType}}">
                and {{name}} = #{{{javaName}}}
            </if>
{{/columns}}
        </where>
        <if test="pageable != null">
            limit #{pageable.offset}, #{pageable.pageSize}
        </if>
    </select>

    <!--统计总行数-->
    <select id="count" resultType="java.lang.Long">
        select count(1)
        from {{tableName}}
        <where>
{{#columns}}
            <if test="{{javaName}} != null{{#isStringType}} and {{javaName}} != ''{{/isStringType}}">
                and {{name}} = #{{{javaName}}}
            </if>
{{/columns}}
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert"{{#primaryKey.isAutoIncrement}} keyProperty="{{primaryKey.javaName}}" useGeneratedKeys="true"{{/primaryKey.isAutoIncrement}}>
        insert into {{tableName}}(
{{#nonPrimaryColumns}}
            {{name}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
        values (
{{#nonPrimaryColumns}}
            #{{{javaName}}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
    </insert>

    <!--批量新增-->
    <insert id="insertBatch"{{#primaryKey.isAutoIncrement}} keyProperty="{{primaryKey.javaName}}" useGeneratedKeys="true"{{/primaryKey.isAutoIncrement}}>
        insert into {{tableName}}(
{{#nonPrimaryColumns}}
            {{name}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
        values
        <foreach collection="entities" item="entity" separator=",">
        (
{{#nonPrimaryColumns}}
            #{entity.{{javaName}}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
        </foreach>
    </insert>

    <!--批量新增或更新-->
    <insert id="insertOrUpdateBatch"{{#primaryKey.isAutoIncrement}} keyProperty="{{primaryKey.javaName}}" useGeneratedKeys="true"{{/primaryKey.isAutoIncrement}}>
        insert into {{tableName}}(
{{#nonPrimaryColumns}}
            {{name}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
        values
        <foreach collection="entities" item="entity" separator=",">
        (
{{#nonPrimaryColumns}}
            #{entity.{{javaName}}}{{^last}},{{/last}}
{{/nonPrimaryColumns}}
        )
        </foreach>
        on duplicate key update
{{#nonPrimaryColumns}}
        {{name}} = values({{name}}){{^last}},{{/last}}
{{/nonPrimaryColumns}}
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update {{tableName}}
        <set>
{{#nonPrimaryColumns}}
            <if test="{{javaName}} != null{{#isStringType}} and {{javaName}} != ''{{/isStringType}}">
                {{name}} = #{{{javaName}}},
            </if>
{{/nonPrimaryColumns}}
        </set>
        where {{primaryKey.name}} = #{{{primaryKey.javaName}}}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from {{tableName}} where {{primaryKey.name}} = #{{{primaryKey.javaName}}}
    </delete>

</mapper>